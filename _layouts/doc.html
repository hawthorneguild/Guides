---
layout: default
---
<div class="doc-container {% if page.toc %}has-toc{% endif %}">

    <div class="doc-content {% unless page.toc %}no-toc{% endunless %}">
        
        <nav class="breadcrumb">
            <a href="{{ site.baseurl }}/">Home</a>
            
            {% assign url_parts = page.url | split: '/' %}
            {% assign current_path = '' %}
            
            {% for part in url_parts %}
                {% unless forloop.first or forloop.last %}
                    {% assign current_path = current_path | append: '/' | append: part %}
                    <span class="breadcrumb-separator">›</span>
                    <a href="{{ site.baseurl }}{{ current_path }}/index/" class="breadcrumb-item linkable">
                        {{ part | replace: '-', ' ' | capitalize }}
                    </a>
                {% endunless %}
            {% endfor %}
            
            <span class="breadcrumb-separator">›</span>
            <span class="breadcrumb-item active">{{ page.title }}</span>
        </nav>

        <h1 class="doc-title">{{ page.title }}</h1>

        {% if page.author or page.date %}
        <div class="doc-meta">
            {% if page.author %}<span class="doc-author">By {{ page.author }}</span>{% endif %}
            {% if page.date %}<span class="doc-date">{{ page.date | date: "%B %d, %Y" }}</span>{% endif %}
        </div>
        {% endif %}

        <div class="doc-body">
            {{ content }}
        </div>

        {% if page.toc %}
        <aside class="doc-toc">
            <h3>On This Page</h3>
            <div id="toc-container"></div>
        </aside>
        {% endif %}

        {% if page.collection %}
        <nav class="doc-footer-nav">
            {% assign collection_items = site[page.collection] | sort: 'order' %}
            {% assign current_index_0 = -1 %}

            {% for item in collection_items %}
                {% if item.url == page.url %}
                    {% assign current_index_0 = forloop.index0 %}
                    {% break %}
                {% endif %}
            {% endfor %}
            
            {% if current_index_0 > 0 %} 
                {% assign prev_item_index = current_index_0 | minus: 1 %}
                {% assign prev_item = collection_items[prev_item_index] %}
                <a href="{{ prev_item.url | relative_url }}" class="prev-link">
                    <span class="nav-arrow">‹</span>
                    <span class="nav-label">{{ prev_item.title }}</span>
                </a>
            {% endif %}
            
            {% assign next_item_index = current_index_0 | plus: 1 %}
            {% if next_item_index < collection_items.size %}
                {% assign next_item = collection_items[next_item_index] %}  
                <a href="{{ next_item.url | relative_url }}" class="next-link">
                    <span class="nav-label">{{ next_item.title }}</span>
                    <span class="nav-arrow">›</span>
                </a>
            {% endif %}
        </nav>
        {% endif %}
    </div>
</div>

{% if page.toc %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const content = document.querySelector('.doc-body');
    const tocContainer = document.getElementById('toc-container');
    
    if (!content || !tocContainer) return;
    
    // 1. Generate Table of Contents
    const headers = content.querySelectorAll('h2, h3');
    if (headers.length === 0) return;
    
    const toc = document.createElement('ul');
    toc.className = 'toc-list';
    
    headers.forEach((header, index) => {
        if (!header.id) { header.id = 'heading-' + index; }
        
        const li = document.createElement('li');
        li.className = 'toc-item toc-' + header.tagName.toLowerCase();
        
        const link = document.createElement('a');
        link.href = '#' + header.id;
        link.textContent = header.textContent;
        link.className = 'toc-link';
        
        li.appendChild(link);
        toc.appendChild(li);
    });
    
    tocContainer.appendChild(toc);

    // 2. Scroll Highlighting
    const tocLinks = toc.querySelectorAll('.toc-link');
    const sections = Array.from(headers);
    let isScrolling = false;

    function highlightNavigation() {
        const scrollPosition = window.scrollY + 150; 
        let currentSection = null;

        sections.forEach(section => {
            if (section.offsetTop <= scrollPosition) {
                currentSection = section;
            }
        });

        tocLinks.forEach(link => {
            link.classList.remove('active');
            if (currentSection && link.getAttribute('href') === '#' + currentSection.id) {
                link.classList.add('active');
            }
        });

        isScrolling = false;
    }

    window.addEventListener('scroll', () => {
        if (!isScrolling) {
            window.requestAnimationFrame(highlightNavigation);
            isScrolling = true;
        }
    });
    
    highlightNavigation();
});
</script>
{% endif %}